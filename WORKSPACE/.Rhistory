names(allstack.blockrep.biomass)[names(allstack.blockrep.biomass) == 'values'] <- 'Biomass'
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=Block, y=Biomass, fill=Replicate)) + geom_boxplot()
box.blockrep.biomass
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=block, y=Biomass, fill=rep())) + geom_boxplot()
box.blockrep.biomass
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=block, y=Biomass, fill=rep) + geom_boxplot()
)
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=block, y=Biomass, fill=rep)) + geom_boxplot()
box.blockrep.biomass
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=block, y=Biomass, fill=rep)) + geom_boxplot(position=position_dodge(.9))
box.blockrep.biomass
allstack.blockrep.biomass$Block = 0
allstack.blockrep.biomass$Replicate = 0
allstack.blockrep.biomass$Replicate[1:70] = "Block"
allstack.blockrep.biomass$Replicate[which(allstack.blockrep.biomass$Replicate == "0")] = "Replicate"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.A.biomass")] = "A"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.B.biomass")] = "B"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.C.biomass")] = "C"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.D.biomass")] = "D"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.E.biomass")] = "E"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.F.biomass")] = "F"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.A.rep.biomass")] = "A"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.B.rep.biomass")] = "B"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.C.rep.biomass")] = "C"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.D.rep.biomass")] = "D"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.E.rep.biomass")] = "E"
allstack.blockrep.biomass$Block[which(allstack.blockrep.biomass$ind == "block.F.rep.biomass")] = "F"
names(allstack.blockrep.biomass)[names(allstack.blockrep.biomass) == 'values'] <- 'Biomass'
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=Block, y=Biomass, fill=Replicate)) + geom_boxplot()
box.blockrep.biomass
box.blockrep.biomass = ggplot(allstack.blockrep.biomass, aes(x=Block, y=Biomass, fill=Replicate)) + geom_boxplot(position=position_dodge(.9))
box.blockrep.biomass
block.A.biomass.test = t.test(block.A.biomass, block.A.rep.biomass, paired = T)
block.A.biomass.test
block.A.biomass.test.np = t.test(block.A.biomass, block.A.rep.biomass)
block.A.biomass.test.np
lm.ndvi.block.phyD = lm(all.prairie$ndviavg.1 ~ all.prairie$block + all.prairie$phyD)
lm.ndvi.block.phyD
summary(lm.ndvi.block.phyD)
anova(lm.ndvi.block.phyD)
TukeyHSD(lm.ndvi.block.phyD, all.prairie$block)
TukeyHSD(all.prairie$ndviavg.1, all.prairie$block)
TukeyHSD(anova(lm.ndvi.block.phyD), all.prairie$block)
aov(lm.ndvi.block.phyD)
TukeyHSD(aov(lm.ndvi.block.phyD), all.prairie$block)
aov.ndvi.block.phyD = aov(all.prairie$ndviavg.1 ~ all.prairie$block + all.prairie$phyD)
aov.ndvi.block.phyD
TukeyHSD(aov.ndvi.block.phyD, all.prairie$block)
TukeyHSD(aov.ndvi.block.phyD, "block")
plot(TukeyHSD(aov.ndvi.block.phyD, all.prairie$block))
summary(lm.ndvi.block.trtD = lm(all.prairie$ndviavg.1 ~ all.prairie$block + all.prairie$trtD))
summary(lm.ndvi.block.trtD <- lm(all.prairie$ndviavg.1 ~ all.prairie$block + all.prairie$trtD))
anova(lm.ndvi.block.trtD)
library(ape)
library(ggtree)
library(magrittr)
library(picante)
ndvi.mat$sp <- dat$blocks$monoTreeName[match(ndvi.mat$plot, dat$blocks$plot)]
ndvi.mat.spl <- split(ndvi.mat, ndvi.mat$sp)
ndvi.mat.mean <- sapply(ndvi.mat.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
View(ndvi.mat.spl)
ndvi.mat.small <- ndvi.mat.mean[c('biomass.monocultures', 'ndvi')]
names(ndvi.mat.small) <- c('Biomass', 'NDVI')
View(ndvi.mat.small)
View(ndvi.mat.mean)
View(ndvi.mat.small)
View(ndvi.mat)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName)
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')]
names(ndvi.mat.small) <- c('Biomass', 'NDVI')
all.prairie.small
View(all.prairie.small)
names(all.prairie.small) <- c('Biomass', 'NDVI')
problem.rows <- which(apply(all.prairie.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
all.prairie.small <- apply(all.prairie.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.40)
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
p
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
p <- p + theme(legend.position = 'none')
p <- p + theme(legend.position = 'none')
p
pdf('../OUT/prairie.biomass.ALTedit.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.39)
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.395)
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
View(all.prairie.small)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(all.prairie.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
all.prairie.small <- apply(all.prairie.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.30) ##changed 0.1 to 0.3 to adjust for calibrated NDVI: Used Asclepias_syriaca as reference.
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALTedit.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
print(p)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
GNDVI.small <- all.prairie.mean[c('biomass.monocultures', 'pGNDVIvalues')] names(GNDVI.small) <- c('Biomass', 'GNDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GNDVI.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
GNDVI.small <- apply(GNDVI.small, 2, function(x) (x - min(x)) / max(x - min(x)))
GNDVI.small <- all.prairie.mean[c('biomass.monocultures', 'pGNDVIvalues')]
names(GNDVI.small) <- c('Biomass', 'GNDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GNDVI.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
GNDVI.small <- apply(GNDVI.small, 2, function(x) (x - min(x)) / max(x - min(x)))
View(GNDVI.small)
problem.rows <- which(apply(GNDVI.small, 1, sum, na.rm = T) < 0.30)
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GNDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GNDVI.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GNDVI.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
print(p)
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')] names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')]
names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
View(GDVI2.small)
problem.rows <- which(apply(GDVI2.small, 1, sum, na.rm = T) < 0.47)
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GDVI2.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GDVI2.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GDVI2.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
print(p)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(all.prairie.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
all.prairie.small <- apply(all.prairie.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.30) ##changed 0.1 to 0.3 to adjust for calibrated NDVI: Used Asclepias_syriaca as reference.
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_NDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
GNDVI.small <- all.prairie.mean[c('biomass.monocultures', 'pGNDVIvalues')]
names(GNDVI.small) <- c('Biomass', 'GNDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GNDVI.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
GNDVI.small <- apply(GNDVI.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(GNDVI.small, 1, sum, na.rm = T) < 0.30)
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GNDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GNDVI.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GNDVI.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(GNDVI.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(GNDVI.small[tr.prairie.phylosig$tip.label, 'GNDVI'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')]
names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(GDVI2.small, 1, sum, na.rm = T) < 0.47)
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GDVI2.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GDVI2.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GDVI2.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(GDVI2.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
GDVI2 = phylosignal(GDVI2.small[tr.prairie.phylosig$tip.label, 'GDVI2'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
ndvi.mat$sp <- dat$blocks$monoTreeName[match(ndvi.mat$plot, dat$blocks$plot)]
ndvi.mat.spl <- split(ndvi.mat, ndvi.mat$sp)
ndvi.mat.mean <- sapply(ndvi.mat.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
ndvi.mat.small <- ndvi.mat.mean[c('biomass.monocultures', 'ndvi')]
names(ndvi.mat.small) <- c('Biomass', 'NDVI')
#for(i in 1:2) ndvi.mat.small[[i]] <- log(ndvi.mat.small[[i]])
#for(i in 1:2) ndvi.mat.small[[i]] <- sqrt(ndvi.mat.small[[i]])
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(ndvi.mat.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) ndvi.mat.small <- ndvi.mat.small[-problem.rows, ]
ndvi.mat.small <- apply(ndvi.mat.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(ndvi.mat.small, 1, sum, na.rm = T) < 0.10)
if(length(problem.rows) > 0) ndvi.mat.small <- ndvi.mat.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
## rescale to 0:1
pdf('../OUT/prairie.biomass.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(ndvi.mat.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = ndvi.mat.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
#  ln.biomass = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass']), tr.prairie.phylosig),
#  ln.NDVI = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI']), tr.prairie.phylosig)
)
View(tr.prairie.biomass.K)
View(tr.prairie.biomass.K)
tr.prairie.biomass.K[["NDVI"]][["PIC.variance.P"]]
View(tr.prairie.biomassPlot)
View(tr.prairie.phylosig)
tr.prairie.phylosig
tr.prairie.biomass.K
tr.prairie.biomass.K$biomass
names(tr.prairie.biomass.K$biomass)
tr.prairie.biomass.K$biomass$K
anova(lm.ndvi.block.phyD)
anova(lm.ndvi.block.trtD)
TukeyHSD(anova(lm.ndvi.block.phyD), which = 'block')
?TukeyHSD
a
TukeyHSD(aov.ndvi.block.phyD)
names(all.prairie)
temp <- lm(biomass.all ~ AHOR_cm + block + AHOR_cm * block)
temp <- lm(biomass.all ~ AHOR_cm + block + AHOR_cm * block, data = all.prairie)
temp
aov(temp)
summary(aov(temp))
summary(temp)
summary(aov(temp))
temp <- lm(biomass.all ~ AHOR_cm + block, data = all.prairie)
summary(temp)
temp <- lm(biomass.all ~ AHOR_cm, data = all.prairie)
summary(temp)
temp <- lm(biomass.all ~ AHOR_cm + block, data = all.prairie)
temp <- glm(biomass.all ~ AHOR_cm + factor(block), data = all.prairie)
temp
summary(temp)
aov(temp)
summary(aov(temp))
