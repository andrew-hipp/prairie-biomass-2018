p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = log(Biomass)))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
ls()
spp.trans
ls()
dat.traits
ls()
dat.fams <- read.delim('../DATA/prairie.spp.list.v11.2016-01-05.tsv', as.is = T)
head(dat.fams)
which(duplicated(dat.fams$treeName))
dat.fams$treeName[which(duplicated(dat.fams$treeName))]
row.names(dat.fams) <- make.unique(gsub(" ", "_", dat.fams$treeName))
sort(row.names(dat.fams))
dat.fams[row.names(dat.mds), 'Family']
which(is.na(dat.fams[row.names(dat.mds), 'Family'])
)
row.names(dat.mds)[which(is.na(dat.fams[row.names(dat.mds), 'Family']))]
tr.prairie$tip.label[which(is.na(dat.fams[tr.prairie$tip.label, 'Family']))]
write.csv(cbind(treeName = tr.prairie$tip.label, family = dat.fams[tr.prairie$tip.label, 'Family']),
         '../DATA/families.csv')
dat.fams <- read.csv('../DATA/families.csv', row.names = 2)
dat.fams
dat.fams <- read.csv('../DATA/families.csv', row.names = 1)
dat.fams
dat.mds <- as.data.frame(dat.traits.mds$points)
dat.mds$Family <- dat.fams[row.names(dat.mds), 'family']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family, shape= Family))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family))
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family))
p.mds <- p.mds + scale_color_brewer(type = 'qual')
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass/5, color = Family))
p.mds <- p.mds + scale_color_brewer(type = 'qual')
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
count(dat.fams$family)
table(dat.fams$family)
sort(table(dat.fams$family))
?scale_color_brewer
?scales::brewer_pal
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family))
p.mds <- p.mds + scale_color_brewer(type = 'qual' palette = 2)
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 2)
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
table(dat.fams$family)
sort(table(dat.fams$family))
tail(sort(table(dat.fams$family)))
tail(sort(table(dat.fams$family)), 7)
dat.fams
?scale_color_brewer
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.fams <- read.csv('../DATA/families.csv', row.names = 1)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = T, row.names = 1)
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- metaMDS(dat.traits[row.names(ndvi.mat.small), 1:13])
dat.mds <- as.data.frame(dat.traits.mds$points)
dat.mds$Family <- dat.fams[row.names(dat.mds), 'family']
dat.mds$Family.8 <- dat.fams[row.names(dat.mds), 'Family.8']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.fams$Family.8
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = T, row.names = 1)
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- metaMDS(dat.traits[row.names(ndvi.mat.small), 1:13])
dat.fams$Family.8
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 3)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.mds
dat.mds$Family.8
dat.fams$Family.8
dat.mds$Family
dat.mds$Biomass
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.traits.mds
source('../SCRIPTS/05.traitNDVI.biomass.R')
?metaMDS
?vegdist
source('../SCRIPTS/05.traitNDVI.biomass.R')
dat.traits.mds
names(dat.traits)
sapply(dat.traits, class)
dput(names(dat.traits))
head(dat.traits)
levels(dat.traits$habitClean)
unique(dat.traits$habitClean)
table(dat.traits$lifeCycleCoded)
table(dat.traits$Lifeform)
table(dat.traits$photosyntheticPathwa)
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- metaMDS(scale(dat.traits[row.names(ndvi.mat.small), dat.traits.use]), 'gower', )
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- metaMDS(dat.traits[row.names(ndvi.mat.small), dat.traits.use], 'gower', )
library(F)
?vegdist
library(FD)
?metaMDS
?gowdis
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- monoMDS(gowdis(dat.traits[row.names(ndvi.mat.small), dat.traits.use]))
dat.mds <- as.data.frame(dat.traits.mds$points)
dat.mds$Family <- dat.fams[row.names(dat.mds), 'family']
dat.mds$Family.8 <- dat.fams[row.names(dat.mds), 'Family.8']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.traits.continuous <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                                              "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                                              "petioleLength","genome_Use")
dat.traits.scaled <- dat.traits[row.names(ndvi.mat.small), dat.traits.use]
for(i in dat.traits.continuous) dat.traits.scaled[[i]] <- scale(dat.traits.scaled[[i]])
dat.traits.scaled
sapply(dat.traits.scaled, class)
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.traits.continuous <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                                              "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                                              "petioleLength","genome_Use")
dat.traits.scaled <- dat.traits[row.names(ndvi.mat.small), dat.traits.use]
for(i in dat.traits.continuous) dat.traits.scaled[[i]] <- as.numeric(scale(dat.traits.scaled[[i]]))
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- monoMDS(gowdis(dat.traits.scaled))
sapply(dat.traits.scaled, class)
dat.mds <- as.data.frame(dat.traits.mds$points)
dat.mds$Family <- dat.fams[row.names(dat.mds), 'family']
dat.mds$Family.8 <- dat.fams[row.names(dat.mds), 'Family.8']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
dat.traits.mds
?envfit
?envfit
args(envfit)
?envfit
dat.traits.env <- envfit(dat.traits.mds, dat.traits.scaled)
plot(dat.traits.env)
plot(dat.traits.mds)
plot(dat.traits.env)
dat.traits.env
dat.traits.cor
library(vegan)
library(FD)
library(geiger)
library(ggplot2)
library(ggrepel)
dat.fams <- read.csv('../DATA/families.csv', row.names = 1, as.is = T)
dat.traits <- read.csv('../DATA/ImputedMiceTraits.2016-01-06.csv',
                       as.is = F, row.names = 1)
dat.traits.use <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                       "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                       "petioleLength", "Lifeform", "photosyntheticPathway", "rhizomes",
                       "habitClean", "nFixer",
                       "wis_IL", "genome_Use")
dat.traits.continuous <- c("seedMass", "LDMC", "SLA", "LNC", "LCC", "LPC", "SDMC", "circularity",
                                              "vegetativeHeight", "leafLength", "leafThickness", "leafWidth",
                                              "petioleLength","genome_Use")
dat.traits.scaled <- dat.traits[row.names(ndvi.mat.small), dat.traits.use]
for(i in dat.traits.continuous) dat.traits.scaled[[i]] <- as.numeric(scale(dat.traits.scaled[[i]]))
dat.fams$Family.8 <- dat.fams$family
dat.fams$Family.8[!dat.fams$family %in% names(tail(sort(table(dat.fams$family)), 7))] <- "Other"
dat.traits.mds <- monoMDS(gowdis(dat.traits.scaled))
dat.mds <- as.data.frame(dat.traits.mds$points)
dat.mds$Family <- dat.fams[row.names(dat.mds), 'family']
dat.mds$Family.8 <- dat.fams[row.names(dat.mds), 'Family.8']
dat.mds$Biomass <- ndvi.mat.mean[row.names(dat.mds), 'biomass.all']
dat.traits.mapping <- data.frame(dat.traits.scaled[c('SDMC', 'circularity', 'vegetativeHeight',
                                'LDMC', 'SLA', 'LCC', 'leafLength', 'leafThickness')],
                                Biomass = ndvi.mat.mean[row.names(dat.mds), 'biomass.all'],
                                NDVI = ndvi.mat.mean[row.names(dat.mds), 'ndvi']
                                )
dat.traits.env <- envfit(dat.traits.mds, dat.traits.scaled)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
plot(dat.traits.env)
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
print(p.mds)
plot(dat.traits.env)
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
names(dat.traits.env)
row.names(dat.traits.env$vectors)
row.names(dat.traits.env$vectors$arrows)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r))
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
head(dat.traits.arrows)
dat.traits.mapping <- data.frame(dat.traits.scaled[c('SDMC', 'circularity', 'vegetativeHeight',
                                'LDMC', 'SLA', 'LCC', 'leafLength', 'leafThickness')],
                                Biomass = ndvi.mat.mean[row.names(dat.mds), 'biomass.all'],
                                NDVI = ndvi.mat.mean[row.names(dat.mds), 'ndvi']
                                )
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r))
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length - unit(0.5, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
p.mds <- p.mds + coord_fixed()
print(p.mds)
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r))
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length = unit(0.5, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
p.mds <- p.mds + coord_fixed()
print(p.mds)
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length = unit(3, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
p.mds <- p.mds + coord_fixed()
print(p.mds)
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r))
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length = unit(0.5, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
#p.mds <- p.mds + coord_fixed()
print(p.mds)
dat.traits.mapping <- data.frame(dat.traits.scaled[c('SDMC', 'circularity', 'vegetativeHeight',
                                'LDMC', 'SLA', 'LCC', 'leafLength', 'leafThickness')],
                                Biomass = ndvi.mat.mean[row.names(dat.mds), 'biomass.all'],
                                NDVI = ndvi.mat.mean[row.names(dat.mds), 'ndvi']
                                )
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r) * 2)
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length = unit(0.5, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
#p.mds <- p.mds + coord_fixed()
print(p.mds)
dat.traits.mapping <- data.frame(dat.traits.scaled[c('SDMC', 'circularity', 'vegetativeHeight',
                                'LDMC', 'SLA', 'LCC', 'leafLength', 'leafThickness')],
                                Biomass = ndvi.mat.mean[row.names(dat.mds), 'biomass.all'],
                                NDVI = ndvi.mat.mean[row.names(dat.mds), 'ndvi']
                                )
dat.traits.env <- envfit(dat.traits.mds, dat.traits.mapping)
dat.traits.arrows <- as.data.frame(dat.traits.env$vector$arrows*sqrt(dat.traits.env$vectors$r) * 3)
dat.traits.arrows$Trait <- row.names(dat.traits.arrows)
p.mds <- ggplot(dat.mds, aes(x = MDS1, y = MDS2))
p.mds <- p.mds + geom_point(aes(size = Biomass, color = Family.8))
p.mds <- p.mds + scale_color_brewer(type = 'qual', palette = 1)
#p.mds <- p.mds <- scale_color_brewer("Top 7 families")
# p.mds <- p.mds + geom_label_repel(label = row.names(dat.mds),point.padding = 1)
#p.mds <- p.mds + theme(legend.position = c(0.9,0.1))
p.mds <- p.mds + geom_segment(data= dat.traits.arrows,
                              aes(x = 0, xend = MDS1, y = 0, yend = MDS2),
                              arrow = arrow(length = unit(0.5, 'cm')), color = 'gray',
                              inherit_aes = FALSE)
p.mds <- p.mds + geom_text(data = dat.traits.arrows, aes(x = MDS1, y = MDS2, label = Trait))
#p.mds <- p.mds + coord_fixed()
print(p.mds)
q()
source('../SCRIPTS/04.phylo.v1.R')
source('../SCRIPTS/04.phylo.v1.R')
tr.prairie.biomass.K
tr.prairie.biomass.K <- data.frame(
  biomass = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig),
  NDVI = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)
#  ln.biomass = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass']), tr.prairie.phylosig),
#  ln.NDVI = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI']), tr.prairie.phylosig)
  )
tr.prairie.biomass.K
phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)
as.numeric(phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig))
phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,]
source('../SCRIPTS/04.phylo.v1.R')
tr.prairie.biomass.K
phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,]
phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1, drop = T]
phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1, drop = F]
as.vector(phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,])
as.numeric(phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,])
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
p.mds
dat.mds
dat.traits.arrows
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
dat.traits.arrows$Mapping_variable
dat.traits.arrows$Mapping_variable
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
dev.off()
dev.off()
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
args(as.factor)
args(factor)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
source('../SCRIPTS/05.traitNDVI.biomass.R', echo = T)
q()
