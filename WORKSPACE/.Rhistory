pdf('../OUT/prairie.biomass.ALT_edit_GNDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GNDVI.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GNDVI.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
print(p)
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')] names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')]
names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
View(GDVI2.small)
problem.rows <- which(apply(GDVI2.small, 1, sum, na.rm = T) < 0.47)
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GDVI2.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GDVI2.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GDVI2.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
print(p)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(all.prairie.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
all.prairie.small <- apply(all.prairie.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.30) ##changed 0.1 to 0.3 to adjust for calibrated NDVI: Used Asclepias_syriaca as reference.
if(length(problem.rows) > 0) all.prairie.small <- all.prairie.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_NDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(all.prairie.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = all.prairie.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
GNDVI.small <- all.prairie.mean[c('biomass.monocultures', 'pGNDVIvalues')]
names(GNDVI.small) <- c('Biomass', 'GNDVI')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GNDVI.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
GNDVI.small <- apply(GNDVI.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(GNDVI.small, 1, sum, na.rm = T) < 0.30)
if(length(problem.rows) > 0) GNDVI.small <- GNDVI.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GNDVI.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GNDVI.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GNDVI.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(GNDVI.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(GNDVI.small[tr.prairie.phylosig$tip.label, 'GNDVI'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
GDVI2.small <- all.prairie.mean[c('biomass.monocultures', 'pGDVI2values')]
names(GDVI2.small) <- c('Biomass', 'GDVI2')
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(GDVI2.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
GDVI2.small <- apply(GDVI2.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(GDVI2.small, 1, sum, na.rm = T) < 0.47)
if(length(problem.rows) > 0) GDVI2.small <- GDVI2.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
pdf('../OUT/prairie.biomass.ALT_edit_GDVI2.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(GDVI2.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = GDVI2.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(GDVI2.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
GDVI2 = phylosignal(GDVI2.small[tr.prairie.phylosig$tip.label, 'GDVI2'], tr.prairie.phylosig)[1,]
)
View(tr.prairie.biomass.K)
ndvi.mat$sp <- dat$blocks$monoTreeName[match(ndvi.mat$plot, dat$blocks$plot)]
ndvi.mat.spl <- split(ndvi.mat, ndvi.mat$sp)
ndvi.mat.mean <- sapply(ndvi.mat.spl, function(x) {
apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
}) %>%
t %>%
as.data.frame
ndvi.mat.small <- ndvi.mat.mean[c('biomass.monocultures', 'ndvi')]
names(ndvi.mat.small) <- c('Biomass', 'NDVI')
#for(i in 1:2) ndvi.mat.small[[i]] <- log(ndvi.mat.small[[i]])
#for(i in 1:2) ndvi.mat.small[[i]] <- sqrt(ndvi.mat.small[[i]])
## remove all NAs and -INF and prune tree
problem.rows <- which(apply(ndvi.mat.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
if(length(problem.rows) > 0) ndvi.mat.small <- ndvi.mat.small[-problem.rows, ]
ndvi.mat.small <- apply(ndvi.mat.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(ndvi.mat.small, 1, sum, na.rm = T) < 0.10)
if(length(problem.rows) > 0) ndvi.mat.small <- ndvi.mat.small[-problem.rows, ]
tr.prairie.biomassPlot <- drop.tip(tr.prairie, names(problem.rows)) %>%
multi2di
tr.prairie.biomassPlot$node.label[tr.prairie.biomassPlot$node.label %in% c('', 'NA')] <- NA
tr.prairie.biomassPlot$node.label <-
c(rep(NA, length(tr.prairie.biomassPlot$tip.label)), tr.prairie.biomassPlot$node.label)
tr.prairie.biomassPlot$tip.label[tr.prairie.biomassPlot$tip.label == 'Symphyotrichum_novaeangliae'] <- "Symphyotrichum_novae-angliae"
## rescale to 0:1
pdf('../OUT/prairie.biomass.pdf')
p <- ggtree(tr.prairie.biomassPlot
#            layout = 'fan',
#            open.anphylosignal(ndvi.mat.small[, tr.prairie.biomassPlot)gle = 15
)
p <- p + geom_label(aes(x = branch), label = tr.prairie.biomassPlot$node.label, size = 2)
p <- gheatmap(p, data = ndvi.mat.small,
low = 'white', high = 'black',
colnames_angle = 315,
font.size = 2,
width = 0.1,
hjust = 0,
)
#p <- p + theme(legend.position = c(0.05,0.9))
p <- p + theme(legend.position = 'none')
print(p)
dev.off()
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.biomass.K <- list(
biomass = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
NDVI = phylosignal(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
#  ln.biomass = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'Biomass']), tr.prairie.phylosig),
#  ln.NDVI = phylosignal(log(ndvi.mat.small[tr.prairie.phylosig$tip.label, 'NDVI']), tr.prairie.phylosig)
)
View(tr.prairie.biomass.K)
View(tr.prairie.biomass.K)
tr.prairie.biomass.K[["NDVI"]][["PIC.variance.P"]]
View(tr.prairie.biomassPlot)
View(tr.prairie.phylosig)
tr.prairie.phylosig
tr.prairie.biomass.K
tr.prairie.biomass.K$biomass
names(tr.prairie.biomass.K$biomass)
tr.prairie.biomass.K$biomass$K
anova(lm.ndvi.block.phyD)
anova(lm.ndvi.block.trtD)
TukeyHSD(anova(lm.ndvi.block.phyD), which = 'block')
?TukeyHSD
a
TukeyHSD(aov.ndvi.block.phyD)
names(all.prairie)
temp <- lm(biomass.all ~ AHOR_cm + block + AHOR_cm * block)
temp <- lm(biomass.all ~ AHOR_cm + block + AHOR_cm * block, data = all.prairie)
temp
aov(temp)
summary(aov(temp))
summary(temp)
summary(aov(temp))
temp <- lm(biomass.all ~ AHOR_cm + block, data = all.prairie)
summary(temp)
temp <- lm(biomass.all ~ AHOR_cm, data = all.prairie)
summary(temp)
temp <- lm(biomass.all ~ AHOR_cm + block, data = all.prairie)
temp <- glm(biomass.all ~ AHOR_cm + factor(block), data = all.prairie)
temp
summary(temp)
aov(temp)
summary(aov(temp))
ls()
source('../SCRIPTS/05.traitNDVI.biomass.R')
install.packages('ggrepel')
source('../SCRIPTS/05.traitNDVI.biomass.R')
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R')
dat.mds$Family
dat.mds$Family.8
as.factor(dat.mds$Family.8)
as.factor(dat.mds$Family.8) %>% levels
as.factor(dat.mds$Family.8) %>% levels %>% dput
dat.mds$Family <- dat.fams[row.names(dat.mds), 'Family.8'] %>%
  as.factor(levels = c("Asclepiadaceae", "Asteraceae", "Cyperaceae",
                       "Fabaceae", "Lamiaceae", "Poaceae", "Rosaceae",
                       "Other"))
dat.mds$Family <- factor(dat.fams[row.names(dat.mds), 'Family.8'],
                          levels = c("Asclepiadaceae", "Asteraceae", "Cyperaceae",
                          "Fabaceae", "Lamiaceae", "Poaceae", "Rosaceae",
                          "Other"))
dat.mds$Family
source('../SCRIPTS/05.traitNDVI.biomass.R')
plot(dat.traits.cor)
install.packages('latex2exp')
library(latex2exp)
TeX('$\\alpha^\\beta$')
source('../SCRIPTS/05.traitNDVI.biomass.R')
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R')
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
?element_text
?theme
?title
?ggplot2::title
??title
source('../SCRIPTS/05.traitNDVI.biomass.R')
dev.off()
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R')
?labs
?legend
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
TeX("Pagel's $\lambda$")
TeX("Pagel's $\\lambda$")
dev.off()
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
q()
?theme
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/05.traitNDVI.biomass.R')
source('../SCRIPTS/04.phylo.v2.R', echo = T)
p
p
tr.prairie.phylosig
tr.prairie.spectra.K
## ahipp 2018-04-12
tr.prairie.biomass.K
do.call('rbind', tr.prairie.spectra.K)
do.call('rbind', tr.prairie.spectra.K) %>% sort
do.call('rbind', tr.prairie.spectra.K) %>% rank
do.call('rbind', tr.prairie.spectra.K)
do.call('rbind', c(tr.prairie.phylosig, tr.prairie.spectra.K))
do.call('rbind', c(tr.prairie.phylosig, tr.prairie.biomass.K))
c(tr.prairie.phylosig, tr.prairie.biomass.K)
do.call('rbind', c(tr.prairie.biomass.K, tr.prairie.spectra.K)
)
p
all.prairie.small
all.prairie.mean
all.prairie.mean %>% head
plot(biomass.monocultures.noGL ~ biomass.monocultures, all.prairie.mean)
dim(all.prairie.mean)
tr.prairie
tr.prairie$tip.label
source('../SCRIPTS/00b.problemSpp.2017.R')
library(magrittr)
source('../SCRIPTS/00b.problemSpp.2017.R')
source('../SCRIPTS/00b.problemSpp.2017.R')
spp.prob.2017
source('../SCRIPTS/00b.problemSpp.2017.R')
spp.prob.2017
spp.prob.2017 %in% tr.prairie$tip.label
p
tr.prairie.biomassPlot
tr.prairie.biomass
tr.prairie.biomassPlot
problem.rows
head(all.prairie.small)
spp.prob.2017 %in% row.names(all.prairie.small)
setdiff(spp.prob.2017,row.names(all.prairie.small))
setdiff(row.names(all.prairie.small), spp.prob.2017)
setdiff(spp.prob.2017,row.names(all.prairie.small))
all.prairie.small
dim(all.prairie.small)
names(problem.rows)
problem.rows
row.names(all.prairie.small)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
  apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
  }) %>%
  t %>%
  as.data.frame %>%
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
row.names(all.prairie.small)
all.prairie.spl <- split(all.prairie, all.prairie$monoTreeName) ##changed ndvi.mat to all.prairie to complie with 01.compileData.R
all.prairie.mean <- sapply(all.prairie.spl, function(x) {
  apply(x, 2, function(y) mean(as.numeric(y), rm.na = T))
  }) %>%
  t %>%
  as.data.frame
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
warnings()
row.names(all.prairie.small)
apply(all.prairie.small, function(x) all(is.na(x)))
apply(all.prairie.small,2, function(x) all(is.na(x)))
message('CHECKING FOR 2017 PROBLEM SPECIES')
if(any(!spp.prob.2017 %in% row.names(all.prairie.small))) {
  message("... the following problem spp were not found:")
  print(setdiff(spp.prob.2017, row.names(all.prairie.small)))
  }
else message("... and all are excluded from all.prairie.small")
all.prairie.small <- all.prairie.small[which(!row.names(all.prairie.small) %in% spp.prob.2017), ]
message('CHECKING FOR 2017 PROBLEM SPECIES')
if(any(!spp.prob.2017 %in% row.names(all.prairie.small))) {
  message("... the following problem spp were not found:")
  print(setdiff(spp.prob.2017, row.names(all.prairie.small)))
  }
else {
  message("... and all are excluded from all.prairie.small")
}
all.prairie.small <- all.prairie.mean[c('biomass.monocultures', 'pNDVIvalues')] ##calibrated NDVI
names(all.prairie.small) <- c('Biomass', 'NDVI')
message('CHECKING FOR 2017 PROBLEM SPECIES')
if(any(!spp.prob.2017 %in% row.names(all.prairie.small))) {
  message("... the following problem spp were not found:")
  print(setdiff(spp.prob.2017, row.names(all.prairie.small)))
  } else
  message("... and all are excluded from all.prairie.small")
all.prairie.small <- all.prairie.small[which(!row.names(all.prairie.small) %in% spp.prob.2017), ]
message('CHECKING FOR 2017 PROBLEM SPECIES')
if(any(!spp.prob.2017 %in% row.names(all.prairie.small))) {
  message("... the following problem spp were not found:")
  print(setdiff(spp.prob.2017, row.names(all.prairie.small)))
  } else
  message("... and all are excluded from all.prairie.small")
all.prairie.small <- all.prairie.small[which(!row.names(all.prairie.small) %in% spp.prob.2017), ]
dim(all.prairie.small)
problem.rows <- which(apply(all.prairie.small, 1, function(x) any(c(-Inf, NaN) %in% x)))
problem.rows
all.prairie.small <- apply(all.prairie.small, 2, function(x) (x - min(x)) / max(x - min(x)))
problem.rows <- which(apply(all.prairie.small, 1, sum, na.rm = T) < 0.30) ##changed 0.1 to 0.3 to adjust for calibrated NDVI: Used Asclepias_syriaca as reference.
problem.rows
tr.prairie.biomassPlot <- drop.tip(tr.prairie, which(!tr.prairie$tip.label %in% row.names(all.prairie.small))) %>%
  multi2di
tr.prairie.biomass
tr.prairie.biomassPlot
setdiff(row.names(all.prairie.small), tr.prairie.biomassPlot$tip.label)
tr.prairie$tip.label
sort(tr.prairie$tip.label)
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.biomassPlot
dim(all.prairie.small)
source('../SCRIPTS/04.phylo.v3.R')
all.prairie.small[rank(all.prairie.small$Biomass), ]
all.prairie.small[rank(all.prairie.small[, 'Biomass']), ]
all.prairie.small[order(all.prairie.small[, 'Biomass']), ]
source('../SCRIPTS/04.phylo.v3.R')
dev.offf()
dev.off()
dev.off()
source('../SCRIPTS/04.phylo.v3.R')
ls(patt = 'tr')
plot(tr.prairie.biomassPlot)
plot(ladderize(tr.prairie.biomassPlot), cex = 0.7)
all.prairie.small[order(all.prairie.small[, 'Biomass']), ]
source('../SCRIPTS/04.phylo.v3.R')
args(do.call)
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.biomass.K
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.biomass.K
do.call('rbind', tr.prairie.biomass.K)
tr.prairie.biomass.K %>% do.call('rbind')
tr.prairie.biomass.K %>% do.call('rbind', .)
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.biomass.K
tr.prairie.phylosig <- tr.prairie.biomassPlot
tr.prairie.phylosig$node.label <- NULL
tr.prairie.phylosignals.K <- list(
  NIR = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pNIRvalues'], tr.prairie.phylosig)[1,],
  REG = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pREGvalues'], tr.prairie.phylosig)[1,],
  RED = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pREDvalues'], tr.prairie.phylosig)[1,],
  GRE = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pGREvalues'], tr.prairie.phylosig)[1,],
  biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
  NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
  ) %>%
  do.call("rbind", .))
tr.prairie.phylosignals.K <- list(
  NIR = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pNIRvalues'], tr.prairie.phylosig)[1,],
  REG = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pREGvalues'], tr.prairie.phylosig)[1,],
  RED = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pREDvalues'], tr.prairie.phylosig)[1,],
  GRE = phylosignal(spectra.small[tr.prairie.phylosig$tip.label, 'pGREvalues'], tr.prairie.phylosig)[1,],
  biomass = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'Biomass'], tr.prairie.phylosig)[1,],
  NDVI = phylosignal(all.prairie.small[tr.prairie.phylosig$tip.label, 'NDVI'], tr.prairie.phylosig)[1,]
  ) %>%
  do.call("rbind", .)
row.names(all.prairie.small) %in% tr.prairie.phylosig$tip.label
names(all.prairie.small)
colnames(all.prairie.small)
all.prairie.small[tr.prairie.phylosig$tip.label, "Biomass"]
all.prairie.small[, "Biomass"]
all.prairie.small[tr.prairie.phylosig$tip.label, ]
setdiff(tr.prairie.phylosig$tip.label, row.names(all.prairie.small))
source('../SCRIPTS/04.phylo.v3.R')
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.phylosignal.K
tr.prairie.phylosignals.K
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.phylosignal.K
names(all.prairie.small)
dim(all.prairie.small)
head(all.prairie.small)
plot(tr.prairie.biomassPlot)
plot(tr.prairie.biomassPlot)
source('../SCRIPTS/04.phylo.v3.R')
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.phylosig.K
tr.prairie.phylosignal.K
warnings()
source('../SCRIPTS/04.phylo.v3.R')
tr.prairie.phylosignal.K
args(write.csv)
?write.csv
source('../SCRIPTS/04.phylo.v3.R')
source('../SCRIPTS/04.phylo.v3.R')
q()
